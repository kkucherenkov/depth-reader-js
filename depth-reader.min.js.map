{"version":3,"sources":["depth-reader.js"],"names":["parseXDM","self","imageNS","xapDescElt","extDescElt","vendorNS","getNS","devPoseNS","camPoseNS","deviceNS","cameraNS","depthNS","noiseNS","perspectNS","xdmRevElt","findChild","devVendElt","camVendElt","devPoseElt","camPoseElt","imagingElt","lastDesc","imageElt","depthElt","confidElt","revision","attrValue","childValue","elemValue","device","vendor","manufacturer","camera","model","pose","latitude","longitude","altitude","positionX","positionY","positionZ","rotationAxisX","rotationAxisY","rotationAxisZ","rotationAngle","perspective","focalLengthX","focalLengthY","principalPointX","principalPointY","depth","metric","parseBool","format","near","far","image","mime","confidence","data","parseLensBlur","focusNS","focus","focalPointX","focalPointY","focalDistance","blurAtInfinity","elt","name","getAttribute","parseRDF","xmpXml","parser","DOMParser","xmlDoc","parseFromString","firstChild","documentElement","err","Error","parent","elts","childNodes","i","length","nodeName","nodeType","nextSibling","ns","getElementsByTagNameNS","textContent","getAttributeNS","makeDataURI","findMarker","buf","pos","getHeader","arr","hasHeader","header","str","baToStr","xmpXapNS","xmpExtNS","len","subarray","String","fromCharCode","apply","j","a","Array","match","xhrResType","Promise","XMLHttpRequest","Canvas","Image","root","this","exports","require","RSVP","DepthReader","isXDM","prototype","parseFile","buffer","bytes","Uint8Array","payload","xmpXapXml","xmpExtXml","isXap","extra","size","start","debug","test","call","loadFile","fileUrl","resolve","reject","xhr","responseType","open","onload","response","fileData","msg","status","send","normalizeDepthmap","bias","_normalized","canvas","src","w","width","h","height","document","createElement","ctx","getContext","drawImage","val","norm","prev","pixels","getImageData","min","max","spread","Math","round","putImageData","toDataURL","module"],"mappings":"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","file":"depth-reader.min.js"}