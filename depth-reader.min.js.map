{"version":3,"sources":["depth-reader.js"],"names":["parseXDM","self","imageNS","xapDescElt","extDescElt","vendorNS","getNS","devPoseNS","camPoseNS","deviceNS","cameraNS","depthNS","noiseNS","perspectNS","xdmRevElt","findChild","devVendElt","camVendElt","devPoseElt","camPoseElt","imagingElt","lastDesc","imageElt","depthElt","confidElt","revision","attrValue","childValue","elemValue","device","vendor","manufacturer","camera","model","pose","latitude","longitude","altitude","positionX","positionY","positionZ","rotationAxisX","rotationAxisY","rotationAxisZ","rotationAngle","perspective","focalLengthX","focalLengthY","principalPointX","principalPointY","depth","metric","parseBool","format","near","far","image","mime","confidence","data","parseLensBlur","focusNS","focus","focalPointX","focalPointY","focalDistance","blurAtInfinity","parseRDF","xmpXml","parser","DOMParser","xmlDoc","parseFromString","rdfDesc","firstChild","documentElement","readNS","err","Error","parent","elts","childNodes","i","length","nodeName","elt","nodeType","nextSibling","ns","name","getElementsByTagNameNS","textContent","getAttributeNS","makeDataURI","findMarker","buf","pos","getHeader","arr","hasHeader","header","str","baToStr","xmpXapNS","xmpExtNS","nsMap","_namespaces","attrs","attributes","prefix","uri","value","test","slice","toLowerCase","prefixes","Object","keys","j","len","subarray","String","fromCharCode","apply","a","Array","match","loadImage","src","img","Promise","resolve","reject","Image","onload","onerror","newCanvas","w","h","Canvas","canvas","document","createElement","width","height","xhrResType","XMLHttpRequest","root","this","exports","require","RSVP","DepthReader","isXDM","prototype","parseFile","buffer","bytes","Uint8Array","payload","xmpXapXml","xmpExtXml","isXap","extra","size","start","debug","call","loadFile","fileUrl","xhr","responseType","open","response","fileData","msg","status","send","normalizeDepthMap","bias","_normalized","then","ctx","getContext","drawImage","val","norm","prev","pixels","getImageData","min","max","spread","Math","round","putImageData","toDataURL","module"],"mappings":"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","file":"depth-reader.min.js"}